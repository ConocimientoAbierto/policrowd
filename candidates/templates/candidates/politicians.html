{% extends 'base.html' %}
{% load i18n %}

{% block title %} {{ area_name }} {% endblock %}

{% block hero %}
    <h1>{% include 'candidates/area_breadcrumb.html' %} {{ area_name }}</h1>
{% endblock %}

{% block content %}

	<div class="internal-areas">
  
    {% if internal_areas_count > 0 %}

		<h2 style="float:left">
		  	<a href="{{ internal_areas_url }}">{% trans "Internal Areas" %}</a>
		</h2>

    {% endif %}
	
		<div style="float:right">
			{% if politician_list_edits_allowed %}
		    <a href="{% url 'create-politician-view' area_id=area_id %}" class="button">{% trans "Add a new candidate" %}</a>
	    {% else %}
	        <a href="{% url 'account_login' %}{% if redirect_after_login %}?next={{ redirect_after_login }}{% endif %}" class="button">{% trans "Sign in to add a new politician" %}</a>
	    {% endif %}
		</div>
	
	</div>

	  <hr>
    {% for powerName, membershipList in memberships.items %}

	  	<div class="poder">
	  		<h2 class="poder-nombre">{{ powerName }}</h2>
		  	<div class="poder-miembros">
		  		{% for membership_indent, membership in membershipList %}
				<div class="politician politician-level-{{ membership_indent }} organization-parent-id-{{ membership.organization.parent_id }}">
	      			<div class="politician-post organization-id-{{ membership.organization.id }}">{{ membership.organization.name }}</div>
	     			<div class="politician-data">
		      			<img class="person-avatar politician-avatar" src="/static/candidates/img/blank-man.png">
			      		<div class="politician-role">
			      			{{ membership.post.role }}  
			      		</div>      		
			      		<div class="politician-name">
			      			<a href="{{ membership.person.url }}">{{ membership.person.name }} {{ membership.person.family_name }}</a> 
			      		</div>      		
		      		</div>
	      		</div>
		  		{% endfor %}
		  	</div>
	  	</div>

    {% endfor %}
    <script type="text/javascript">
    	$(".politician-post").click(function(e) {
    		$(e.currentTarget).find("+ .politician-data").toggle();
    		organization_id = $(e.currentTarget).attr("class").split("organization-id-")[1];
    		console.log(".organization-parent-id-"+organization_id,$(e.currentTarget).attr("class"),$(e.currentTarget).attr("class").split("organization-id-"))
    		$(".organization-parent-id-"+organization_id).toggle();
    	})
    </script>
{% endblock %}
